@inject IOptions<SiteInfoDto> _siteInfoOptions
@inject ICartService _cartService
@{
    var forCloneCartItem = new CartItem();
    var cartItems = _cartService.GetCartItems();
    var totalCartPrice = cartItems.Sum(ci => ci.Qty * ci.Price);
    var isCartItemsEmpty = cartItems.IsNullOrEmpty();
}

<!DOCTYPE html>
<html lang="en" dir="rtl">

<head>
    <meta charset="utf-8">
    <title>@_siteInfoOptions.Value.Title</title>
    <!-- SEO Meta Tags-->
    <meta name="description" content="@_siteInfoOptions.Value.Description">
    <meta name="keywords" content="@_siteInfoOptions.Value.Keywords">
    <!-- Viewport-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Favicon and Touch Icons-->
    <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
    <link rel="mask-icon" color="#fe6a6a" href="safari-pinned-tab.svg">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="theme-color" content="#ffffff">
    <!-- Vendor Styles including: Font Icons, Plugins, etc.-->
    <link rel="stylesheet" media="screen" href="~/css/simplebar.css" />
    <link rel="stylesheet" media="screen" href="~/css/tiny-slider.css" />
    <link rel="stylesheet" media="screen" href="~/css/drift-basic.css" />
    <link rel="stylesheet" media="screen" href="~/css/no-ui-slider.css" />
    <!-- Main Theme Styles + Bootstrap-->
    <link rel="stylesheet" media="screen" href="~/css/theme.css">
    @RenderSection("Styles", required: false)
</head>
<!-- Body-->

<body class="handheld-toolbar-enabled">
    <main class="page-wrapper">
        <!-- Quick View Modal-->
        <div class="modal-quick-view modal fade" id="quick-view" tabindex="-1">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title product-title"><a href="shop-single-v1.html" data-bs-toggle="tooltip" data-bs-placement="right" title="Go to product page">Sports Hooded Sweatshirt<i class="ci-arrow-right fs-lg ms-2"></i></a></h4>
                        <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row">
                            <!-- Product gallery-->
                            <div class="col-lg-7 pe-lg-0">
                                <div class="product-gallery">
                                    <div class="product-gallery-preview order-sm-2">
                                        <div class="product-gallery-preview-item active" id="first">
                                            <img class="image-zoom" src="img/shop/single/gallery/01.jpg" data-zoom="img/shop/single/gallery/01.jpg" alt="Product image">
                                            <div class="image-zoom-pane"></div>
                                        </div>
                                        <div class="product-gallery-preview-item" id="second">
                                            <img class="image-zoom" src="img/shop/single/gallery/02.jpg" data-zoom="img/shop/single/gallery/02.jpg" alt="Product image">
                                            <div class="image-zoom-pane"></div>
                                        </div>
                                        <div class="product-gallery-preview-item" id="third">
                                            <img class="image-zoom" src="img/shop/single/gallery/03.jpg" data-zoom="img/shop/single/gallery/03.jpg" alt="Product image">
                                            <div class="image-zoom-pane"></div>
                                        </div>
                                        <div class="product-gallery-preview-item" id="fourth">
                                            <img class="image-zoom" src="img/shop/single/gallery/04.jpg" data-zoom="img/shop/single/gallery/04.jpg" alt="Product image">
                                            <div class="image-zoom-pane"></div>
                                        </div>
                                    </div>
                                    <div class="product-gallery-thumblist order-sm-1">
                                        <a class="product-gallery-thumblist-item active" href="#first"><img src="img/shop/single/gallery/th01.jpg" alt="Product thumb"></a><a class="product-gallery-thumblist-item" href="#second"><img src="img/shop/single/gallery/th02.jpg" alt="Product thumb"></a>
                                        <a class="product-gallery-thumblist-item" href="#third"><img src="img/shop/single/gallery/th03.jpg" alt="Product thumb"></a><a class="product-gallery-thumblist-item" href="#fourth"><img src="img/shop/single/gallery/th04.jpg" alt="Product thumb"></a>
                                    </div>
                                </div>
                            </div>
                            <!-- Product details-->
                            <div class="col-lg-5 pt-4 pt-lg-0 image-zoom-pane">
                                <div class="product-details ms-auto pb-3">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <a href="shop-single-v1.html#reviews">
                                            <div class="star-rating">
                                                <i class="star-rating-icon ci-star-filled active"></i><i class="star-rating-icon ci-star-filled active"></i><i class="star-rating-icon ci-star-filled active"></i><i class="star-rating-icon ci-star-filled active"></i>
                                                <i class="star-rating-icon ci-star"></i>
                                            </div><span class="d-inline-block fs-sm text-body align-middle mt-1 ms-1">74 Reviews</span>
                                        </a>
                                        <button class="btn-wishlist" type="button" data-bs-toggle="tooltip" title="Add to wishlist"><i class="ci-heart"></i></button>
                                    </div>
                                    <div class="mb-3">
                                        <span class="h3 fw-normal text-accent me-1">$18.<small>99</small></span>
                                        <del class="text-muted fs-lg me-3">$25.<small>00</small></del><span class="badge bg-danger badge-shadow align-middle mt-n2">Sale</span>
                                    </div>
                                    <div class="fs-sm mb-4"><span class="text-heading fw-medium me-1">Color:</span><span class="text-muted" id="colorOptionText">Red/Dark blue/White</span></div>
                                    <div class="position-relative me-n4 mb-3">
                                        <div class="form-check form-option form-check-inline mb-2">
                                            <input class="form-check-input" type="radio" name="color" id="color1" data-bs-label="colorOptionText" value="Red/Dark blue/White" checked>
                                            <label class="form-option-label rounded-circle" for="color1"><span class="form-option-color rounded-circle" style="background-image: url(img/shop/single/color-opt-1.png)"></span></label>
                                        </div>
                                        <div class="form-check form-option form-check-inline mb-2">
                                            <input class="form-check-input" type="radio" name="color" id="color2" data-bs-label="colorOptionText" value="Beige/White/Black">
                                            <label class="form-option-label rounded-circle" for="color2"><span class="form-option-color rounded-circle" style="background-image: url(img/shop/single/color-opt-2.png)"></span></label>
                                        </div>
                                        <div class="form-check form-option form-check-inline mb-2">
                                            <input class="form-check-input" type="radio" name="color" id="color3" data-bs-label="colorOptionText" value="Dark grey/White/Mustard">
                                            <label class="form-option-label rounded-circle" for="color3"><span class="form-option-color rounded-circle" style="background-image: url(img/shop/single/color-opt-3.png)"></span></label>
                                        </div>
                                        <div class="product-badge product-available mt-n1"><i class="ci-security-check"></i>Product available</div>
                                    </div>
                                    <form class="mb-grid-gutter">
                                        <div class="mb-3">
                                            <label class="fw-medium pb-1" for="product-size">Size:</label>
                                            <select class="form-select" required id="product-size">
                                                <option value="">Select size</option>
                                                <option value="xs">XS</option>
                                                <option value="s">S</option>
                                                <option value="m">M</option>
                                                <option value="l">L</option>
                                                <option value="xl">XL</option>
                                            </select>
                                        </div>
                                        <div class="mb-3 d-flex align-items-center">
                                            <select class="form-select me-3" style="width: 5rem;">
                                                <option value="1">1</option>
                                                <option value="2">2</option>
                                                <option value="3">3</option>
                                                <option value="4">4</option>
                                                <option value="5">5</option>
                                            </select>
                                            <button class="btn btn-primary d-block w-100" type="submit"><i class="ci-cart fs-lg me-2"></i>Add to Cart</button>
                                        </div>
                                    </form>
                                    <h5 class="h6 mb-3 pb-2 border-bottom"><i class="ci-announcement text-muted fs-lg align-middle mt-n1 me-2"></i>Product info</h5>
                                    <h6 class="fs-sm mb-2">Style</h6>
                                    <ul class="fs-sm ps-4">
                                        <li>Hooded top</li>
                                    </ul>
                                    <h6 class="fs-sm mb-2">Composition</h6>
                                    <ul class="fs-sm ps-4">
                                        <li>Elastic rib: Cotton 95%, Elastane 5%</li>
                                        <li>Lining: Cotton 100%</li>
                                        <li>Cotton 80%, Polyester 20%</li>
                                    </ul>
                                    <h6 class="fs-sm mb-2">Art. No.</h6>
                                    <ul class="fs-sm ps-4 mb-0">
                                        <li>183260098</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Navbar 3 Level (Light)-->
        <header class="shadow-sm">
            <!-- Remove "navbar-sticky" class to make navigation bar scrollable with the page.-->
            <div class="navbar-sticky bg-light">
                <div class="navbar navbar-expand-lg navbar-light">
                    <div class="container">
                        <a class="navbar-brand d-none d-sm-block flex-shrink-0" asp-area="" asp-controller="Home" asp-action="Index">
                            <img src="~/resources/img/site/logo-dark.png" width="142" alt="Cartzilla">
                        </a>
                        <a class="navbar-brand d-sm-none flex-shrink-0 me-2" asp-area="" asp-controller="Home" asp-action="Index">
                            <img src="img/logo-icon.png" width="74" alt="Cartzilla">
                        </a>
                        <div class="input-group d-none d-lg-flex mx-4">
                            <input class="form-control rounded-end pe-5" type="text" placeholder="جستجوی محصولات"><i class="ci-search position-absolute top-50 end-0 translate-middle-y text-muted fs-base me-3"></i>
                        </div>
                        <div class="navbar-toolbar d-flex flex-shrink-0 align-items-center">
                            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"><span class="navbar-toggler-icon"></span></button><a class="navbar-tool navbar-stuck-toggler" href="#">
                                <span class="navbar-tool-tooltip">Expand menu</span>
                                <div class="navbar-tool-icon-box"><i class="navbar-tool-icon ci-menu"></i></div>
                            </a>
                            <a class="navbar-tool d-none d-lg-flex" asp-area="User" asp-controller="Wish" asp-action="Index">
                                <span class="navbar-tool-tooltip">علاقه مندی ها</span>
                                <div class="navbar-tool-icon-box"><i class="navbar-tool-icon ci-heart"></i></div>
                            </a>
                            <a class="navbar-tool" href="#signin-modal" data-bs-toggle="modal">
                                <span class="navbar-tool-tooltip">ورود یا ثبت نام</span>
                                <div class="navbar-tool-icon-box"><i class="navbar-tool-icon ci-user"></i></div>
                            </a>
                            <div id="cart-nav" class="navbar-tool dropdown ms-3">
                                <a class="navbar-tool-icon-box bg-secondary dropdown-toggle" href="#">
                                    <span class="navbar-tool-label" v-if="cartItems.length > 0">{{ cartItems.length }}</span>
                                    <i class="navbar-tool-icon ci-cart"></i>
                                </a>
                                <!-- Cart dropdown-->
                                <div class="dropdown-menu dropdown-menu-end">
                                    <div style="width: 20rem;" v-if="cartItems.length == 0">
                                        <div class="text-center">
                                            <i class="ci-basket fs-1 my-2 navbar-tool-icon opacity-50 text-primary"></i>
                                            <p class="fs-sm">سبد خرید شما خالی است.</p>
                                        </div>
                                    </div>
                                    <div class="widget widget-cart px-3 pt-2 pb-3" style="width: 25rem;" v-if="cartItems.length > 0">
                                        <div style="max-height: 15rem;" data-simplebar data-simplebar-auto-hide="false">
                                            <div class="widget-cart-item pb-2 border-bottom" v-for="item in cartItems">
                                                @*<button class="btn-close text-danger" type="button" @@click="removeFromCart(item.productId)"><span aria-hidden="true">&times;</span></button>*@
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <div class="d-flex align-items-center">
                                                    <a class="flex-shrink-0" href="shop-single-v1.html">
                                                        <img :src="item.product.firstLargeImageFullPath" width="64" alt="Product">
                                                    </a>
                                                    <div class="ps-2">
                                                        <h6 class="widget-product-title"><a href="shop-single-v1.html">{{item.product.name}}</a></h6>
                                                        <div class="widget-product-meta">
                                                                <span class="text-accent me-2">{{item.price | format_number}}</span>
                                                            <span class="text-muted"> × </span>
                                                                <span class="text-accent ms-2">{{item.qty | format_number}}</span>
                                                        </div>
                                                    </div>
                                                    </div>
                                                    <div>
                                                        <div class="btn-group-vertical btn-group-sm">
                                                            <button class="btn px-2 py-0" @@click="updateCount(item, true)" type="button"><i class="ci-arrow-up text-accent"></i></button>
                                                            <button class="btn px-2 py-0" @@click="removeFromCart(item.productId)" type="button"><i class="ci-close text-danger"></i></button>
                                                            <button class="btn px-2 py-0" @@click="updateCount(item, false)" type="button"><i class="ci-arrow-down text-accent"></i></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="d-flex flex-wrap justify-content-between align-items-center py-3">
                                            <div class="fs-sm me-2 py-2">
                                                <span class="text-muted">مجموع : </span>
                                                <span class="text-accent fs-base ms-1">{{ totalRequest | format_number}}<small> تومان</small></span>
                                            </div>
                                            <a class="btn btn-outline-secondary btn-sm" asp-area="User" asp-asp-controller="Cart" asp-action="Index">
                                                مشاهده سبد خرید <i class="ci-arrow-right ms-2 me-n1"></i>
                                            </a>
                                        </div>
                                        <a class="btn btn-primary btn-sm d-block w-100" asp-area="User" asp-asp-controller="Checkout" asp-action="Index">
                                            تایید و ادامه خرید <i class="ci-card ms-2 fs-base align-middle"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="navbar navbar-expand-lg navbar-light navbar-stuck-menu mt-n2 pt-0 pb-2">
                    <div class="container">
                        <div class="collapse navbar-collapse" id="navbarCollapse">
                            <!-- Search-->
                            <div class="input-group d-lg-none my-3">
                                <i class="ci-search position-absolute top-50 start-0 translate-middle-y text-muted fs-base ms-3"></i>
                                <input class="form-control rounded-start" type="text" placeholder="جستجوی محصولات">
                            </div>
                            <!-- Departments menu-->
                            <ul class="navbar-nav navbar-mega-nav pe-lg-2 me-lg-2">
                                <li class="nav-item dropdown">
                                    <a class="nav-link dropdown-toggle ps-lg-0" href="#" data-bs-toggle="dropdown"><i class="ci-view-grid me-2"></i>برندهای محصولات</a>
                                    <div class="dropdown-menu px-2 pb-4">
                                        <div class="d-flex flex-wrap flex-sm-nowrap">
                                            <div class="mega-dropdown-column pt-3 pt-sm-4 px-2 px-lg-3">
                                                <div class="widget widget-links">
                                                    <a class="d-block overflow-hidden rounded-3 mb-3" href="#"><img src="~/resources/img/departments/01.jpg" alt="Clothing"></a>
                                                    <h6 class="fs-base mb-2">Clothing</h6>
                                                    <ul class="widget-list">
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Women's clothing</a></li>
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Men's clothing</a></li>
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Kid's clothing</a></li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <div class="mega-dropdown-column pt-4 px-2 px-lg-3">
                                                <div class="widget widget-links">
                                                    <a class="d-block overflow-hidden rounded-3 mb-3" href="#"><img src="~/resources/img/departments/02.jpg" alt="Shoes"></a>
                                                    <h6 class="fs-base mb-2">Shoes</h6>
                                                    <ul class="widget-list">
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Women's shoes</a></li>
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Men's shoes</a></li>
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Kid's shoes</a></li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <div class="mega-dropdown-column pt-4 px-2 px-lg-3">
                                                <div class="widget widget-links">
                                                    <a class="d-block overflow-hidden rounded-3 mb-3" href="#"><img src="~/resources/img/departments/03.jpg" alt="Gadgets"></a>
                                                    <h6 class="fs-base mb-2">Gadgets</h6>
                                                    <ul class="widget-list">
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Smartphones &amp; Tablets</a></li>
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Wearable gadgets</a></li>
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">E-book readers</a></li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="d-flex flex-wrap flex-sm-nowrap">
                                            <div class="mega-dropdown-column pt-4 px-2 px-lg-3">
                                                <div class="widget widget-links">
                                                    <a class="d-block overflow-hidden rounded-3 mb-3" href="#"><img src="~/resources/img/departments/04.jpg" alt="Furniture"></a>
                                                    <h6 class="fs-base mb-2">Furniture &amp; Decor</h6>
                                                    <ul class="widget-list">
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Home furniture</a></li>
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Office furniture</a></li>
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Lighting and decoration</a></li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <div class="mega-dropdown-column pt-4 px-2 px-lg-3">
                                                <div class="widget widget-links">
                                                    <a class="d-block overflow-hidden rounded-3 mb-3" href="#"><img src="~/resources/img/departments/05.jpg" alt="Accessories"></a>
                                                    <h6 class="fs-base mb-2">Accessories</h6>
                                                    <ul class="widget-list">
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Hats</a></li>
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Sunglasses</a></li>
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Bags</a></li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <div class="mega-dropdown-column pt-4 px-2 px-lg-3">
                                                <div class="widget widget-links">
                                                    <a class="d-block overflow-hidden rounded-3 mb-3" href="#"><img src="~/resources/img/departments/06.jpg" alt="Entertainment"></a>
                                                    <h6 class="fs-base mb-2">Entertainment</h6>
                                                    <ul class="widget-list">
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Kid's toys</a></li>
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Video games</a></li>
                                                        <li class="widget-list-item mb-1"><a class="widget-list-link" href="#">Outdoor / Camping</a></li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                            <!-- Primary menu-->
                            <ul class="navbar-nav">
                                <li class="nav-item"><a class="nav-link" asp-area="" asp-controller="Home" asp-action="Index">خانه</a></li>
                                <li class="nav-item"><a class="nav-link" asp-area="" asp-controller="Product" asp-action="Index">لیست محصولات</a></li>
                                <li class="nav-item"><a class="nav-link" asp-area="" asp-controller="Home" asp-action="Faq">سوالات متداول</a></li>
                                <li class="nav-item"><a class="nav-link" asp-area="" asp-controller="Home" asp-action="About">درباره ما</a></li>
                                <li class="nav-item"><a class="nav-link" asp-area="" asp-controller="Home" asp-action="Contact">تماس با ما</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        @RenderBody()
    </main>
    <!-- Footer-->
    <partial name="_FooterPartial" />
    <div class="modal fade" id="form-modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
            </div>
        </div>
    </div>

    <!-- Toolbar for handheld devices (Default)-->
    <div class="handheld-toolbar">
        <div class="d-table table-layout-fixed w-100">
            <a class="d-table-cell handheld-toolbar-item" href="account-wishlist.html"><span class="handheld-toolbar-icon"><i class="ci-heart"></i></span><span class="handheld-toolbar-label">Wishlist</span></a><a class="d-table-cell handheld-toolbar-item"
                                                                                                                                                                                                                     href="javascript:void(0)" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" onclick="window.scrollTo(0, 0)"><span class="handheld-toolbar-icon"><i class="ci-menu"></i></span><span class="handheld-toolbar-label">Menu</span></a><a class="d-table-cell handheld-toolbar-item"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                   href="shop-cart.html"><span class="handheld-toolbar-icon"><i class="ci-cart"></i><span class="badge bg-primary rounded-pill ms-1">4</span></span><span class="handheld-toolbar-label">$265.00</span></a>
        </div>
    </div>
    <!-- Back To Top Button-->
    <a class="btn-scroll-top" href="#top" data-scroll><span class="btn-scroll-top-tooltip text-muted fs-sm me-2">بالا</span><i class="btn-scroll-top-icon ci-arrow-up">   </i></a>
    <!-- Vendor scrits: js libraries and plugins-->
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/js/bootstrap.js"></script>
    <script src="~/js/simplebar.js"></script>
    <script src="~/js/tiny-slider.js"></script>
    <script src="~/js/smooth-scroll.js"></script>
    <script src="~/js/drift-basic.js"></script>
    <script src="~/js/no-ui-slider.js"></script>
    <!-- Main theme script-->
    <script src="~/js/theme.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.26.1/axios.min.js"></script>
    <script src="~/js/vue.js"></script>
    <script>
        Vue.filter('format_number', function (value){
            return parseInt(value).toLocaleString()
        })
    </script>
    <script src="~/js/site-scripts/cart-vue/sidebar-cart.js"></script>

    <!-- Sign in / sign up modal-->
    <partial name="_AccountPartial" model="@new AccountViewModel()" />
    @await RenderSectionAsync("Scripts", required: false)

</body>

</html>